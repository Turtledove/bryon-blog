#android 学习之UI，自定义组件，绘图，动画

标签： android 学习
    该文档是记录android学习历程，如有错误之处，请之处，不胜感激！

---
[TOC]
##**一、常用UI组件**

####**（1） LinerLayout 线性布局方式(常用)**
在LinerLayout 里面View 按照vercial或者horizontal方向依次排列。
      
 - **关键属性**：
    + *Layout_gravity* : 指View在Layout中的布局方式（Top,Center,Bottom...），当LinerLayout的排列属 性为vercial时，layout_gravity只有水平方向上的属性有效，同理，当LinerLayout的排列属性为horizontal时，layout_gravity只有在垂直方向上的属性有效
    
    + *Layout_weight*  :  根据比例和layout分配View的大小，`将需要根据比例分配的width或者height设置城0是比较规范的写法`,layout_weight 使用小技巧，一行控件中，如果其中只有一个使用layout_weight=1,那么该控件将沾满剩余空间
 - **layout_gravity 和gravity 的区别？**
    前者是指View在Layout中的布局方式，而后者是只当前View中文字等的布局方式

####**（2） RelativeLayout 相对布局方式(常用)**

 RelativeLayout 中的View将根据RelativeLayout和其他View的位置进行布局，例如View1 位于RelativeLayout的底部（bottom）,位于View2的右边（toRightOF）. 比LinerLayout布局方式更为灵活，同时属性更多，但是Relativelayout的属性都比较容易理解和有迹可循。主要可分为相对于parent的属性，和相对于其他brother的属性，而相对于其他brother的属性可分为：对齐类属性和方位类属性
         
 - **关键属性**： 
   + **相对于parent属性**，例如：layout_alignParentBottom，layout_alignParentTop等
   + **相对于其他brothers的属性**，又分为方位和对齐两种，例如：layout_toLeftOf（方位），layout_alignRight（对齐）等。
     * 方位 ，例如，layout_toLeftOf=“@id/view1” 当前view 位于view1的左边
     * 对齐， 例如layout_alignRight=“@id/view1” 当前view 和view1 右对齐

####**（3） FrameLayout 帧布局方式(不常用)**
 所有的控件（View）都叠加在左上角的位置，不可以进行位置的布局，仅能通过layout_gravity来布局。应用场景比较少，个人能够想像到的使用有，背景图片轮换或者做类似换页的效果，但是这样做之后不知能够有性能的提高或者好处？
         
####**（4） TableLayout 表格布局方式（不常用）**
 TableLayout布局顾名思义就是用来生成表格的布局，使用TableRow来生成一行数据包含若干列，每一列单元格的宽度由该列最宽的元素决定，每个子View是不能设置宽度width:
>The children of a TableLayout cannot specify the layout_width attribute. Width is always MATCH_PARENT. However, the layout_height attribute can be defined by a child; default value is WRAP_CONTENT. If the child is a TableRow, then the height is always WRAP_CONTENT.

常用的子View是TableView,如果使用其他View的话，会默认该View为一行

 **关键属性**
 
 - android:shrinkColumns="1" 当空间不够的时候压缩第二列
 - android:stretchColumns="0"当空间过多的时候，扩展第一列去matchparent
 - android:layout_span="2"   当前单元格的控件占据几个单元格
 - android:collapseColumns="1" 隐藏第二列
 
##**二、自定义UI组件**
 **//TODO**
 - 测量onMeasure()
 - 布局onlayout()
 - 绘图onDraw()

##**三、绘图**

android 绘图只要依赖画布Canvas，画笔Paint。其中画布Canvas 提供两种构造函数：
    
- Canvas()：创建一个空的Canvas对象。
- Canvas(Bitmap bitmap)：创建一个以bitmap位图为背景的Canvas。、

**Drawable,Canvas,Paint区别与联系**

- Drawable ,BitMap 等代表画到哪里去
- Canvas 代表画什么东西上去，画圆，画矩阵，画图，还是其他
- Paint 代表怎么画？用什么颜色，要不要填充等

    


##**四、动画**
###**1 基本应用**
主要由抽象动画类Animation来做相关动画，Animation主要有一下5个动画类
     
 - AlphaAnimation  渐变动画类
 - RotateAnimation 旋转动画类
 - ScaleAnimation 缩放动画类
 - TranslateAnimation 移动动画类
 - AnimationSet     动画集合类，可以包含多个以上动画来同时执行
 
 AlphaAnimation，RotateAnimation，ScaleAnimationTranslateAnimation四种动画的初始化都可以通过代码和xml配置来实现，下面通过AlphaAnimation来做示例：

 - 通过代码实现

```
  //初始化动画参数，这里是渐变前后的透明度
  AlphaAnimation alpha = new AlphaAnimation(1f,0.1f);
  //设置动画的执行时间
  alpha.setDuration(1000);
  //启动动画
  view.startAnimation(scaleAnimation);
```
 其他动画初始化和使用类似，只有相关参数不同。只有AnimationSet 动画集的使用不同，如下所示：
 
```
  Animation alpha = new AlphaAnimation(1f,0.1f);
  //初始化 Translate动画  
  Animation translateAnimation = new TranslateAnimation(0.1f, 100.0f,0.1f,100.0f);  
  //定义动画集，true/false时候共享集合的Interpolator
  AnimationSet animationSet = new AnimationSet(true);
  //添加动画到动画集
  animationSet.addAnimation(translateAnimation);  
  animationSet.addAnimation(alphaAnimation);  
  animationSet.setDuration(1000);  
  view.startAnimation(animationSet);     
```
 
 - XML配置动画
    任然以AlphaAnimation为例：
```
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android">
	<alpha
		android:fromAlpha="1.0"
		android:toAlpha="0.1"
		android:duration="1000"
	/>
</set>
```
在代码中加载
```
  Animation alphaAnimation = AnimationUtils.loadAnimation(this.getContext(), R.anim.alpha_anim);  
```
###**2 Interpolator**
    Interpolator 用来修饰动画效果，加速，减速，弹跳等，可以根据需求自定义，也可以使用android提供的效果[^android Interpolater]:
  
 - AccelerateDecelerateInterpolator,
 - AccelerateInterpolator, 
 - AnticipateInterpolator,
 - AnticipateOvershootInterpolator,
 - BounceInterpolator, 
 - CycleInterpolator,
 - DecelerateInterpolator, 
 - LinearInterpolator, 
 - OvershootInterpolator, 
 - PathInterpolator

##**五、其他**
###1 Drawable与 Bitmap 的区别
Drawable是一种“可绘制”的对象，而Bitmap 则是最简单的在一种Drawable。但是二者之间并没有继承或者实现的关系。
>A Drawable is a general abstraction for "something that can be drawn." and Bitmap: the simplest Drawable, a PNG or JPEG image.


###2 告别 findViewById
  findViewById 好吧这个东西让人很恶心，特别是要操作大量的View的时候，想要消除他，首先想到的是使用一个更短的函数来替代他，但是不能消除类型转换，这个时候结合泛型来消除类型转换：
```
    private <T> T $(int resid){
        return (T)findViewById(resId);
     }
```
把这个函数放在YourActivity 或者公用BaseActivity中，每次使用的时候只要：
```
  ImageView iv_icon = $(R.id.iv_icon);
```
 相对于findViewById已经简单了很多，还是需要去初始化，想起Spring通过注解的形式来注入Bean,虽然这里的性质和Spring不一样，但是也可以通过注解和反射来实现初始化View。目前已经有人做出成熟的框架Butter Knife[^Butter Knife],还可以绑定资源和OnClick监听事件。示例如下[^Butter Knife]：
```
class ExampleActivity extends Activity {
  @Bind(R.id.user) EditText username;
  @Bind(R.id.pass) EditText password;

  @BindString(R.string.login_error)
  String loginErrorMessage;

  @OnClick(R.id.submit) void submit() {
    // TODO call server...
  }
  @Override public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.simple_activity);
    ButterKnife.bind(this);
    // TODO Use fields...
  }
}
```
    
    
[^android Interpolater]: http://developer.android.com/reference/android/view/animation/BaseInterpolator.html

[^Butter Knife]: https://github.com/JakeWharton/butterknife